<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Scheme Details</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header>
        <!-- ...existing header code... -->
    </header>
    <main>
        <div class="container" style="max-width:700px;margin:2rem auto;">
            <div class="card fade-in" id="scheme-details-card" style="padding:2rem;">
                <h2 id="scheme-title" class="section-title mb-4">Loading...</h2>
                <div id="scheme-description" class="mb-4"></div>
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div class="card" style="padding:1rem;">
                        <h3 style="color:#74B83E;">Eligibility</h3>
                        <div id="scheme-eligibility"></div>
                    </div>
                    <div class="card" style="padding:1rem;">
                        <h3 style="color:#74B83E;">Benefits</h3>
                        <div id="scheme-benefits"></div>
                    </div>
                </div>
                <div class="card" style="padding:1rem;">
                    <h3 style="color:#74B83E;">Application Info</h3>
                    <div id="apply-section"></div>
                </div>
                <div class="mt-8 text-center">
                    <a href="schemes.html" class="btn btn-secondary">‚Üê Back to Schemes</a>
                </div>
            </div>
        </div>
    </main>
    <footer>
        <!-- ...existing footer code... -->
    </footer>
    <script src="js/api.js"></script>
    <script>
        // Check user authentication
        const user = localStorage.getItem('user');
        if (!user) {
            alert('Please login or register to view scheme details.');
            window.location.href = 'login.html';
        }

        const urlParams = new URLSearchParams(window.location.search);
        const schemeId = urlParams.get('id');

        if (schemeId) {
            window.API.schemes.getSchemeById(schemeId)
                .then(data => {
                    document.getElementById('scheme-title').textContent = data.title || 'Scheme Details';

                    // Description
                    let descHtml = '';
                    if (data.description) descHtml += `<p>${data.description}</p>`;
                    if (data.category) descHtml += `<p><span class="badge badge-primary">${data.category}</span></p>`;
                    if (data.district) descHtml += `<p><strong>District:</strong> ${data.district}</p>`;
                    document.getElementById('scheme-description').innerHTML = descHtml;

                    // Eligibility
                    const eligibility = data.eligibility;
                    let eligibilityHtml = '<ul>';
                    if (eligibility) {
                        if (eligibility.age) {
                            eligibilityHtml += `<li><strong>Age:</strong> ${eligibility.age.min || ''} - ${eligibility.age.max || ''}</li>`;
                        }
                        if (eligibility.income) {
                            eligibilityHtml += `<li><strong>Income:</strong> ${eligibility.income.min || ''} - ${eligibility.income.max || ''}</li>`;
                        }
                        if (eligibility.education) {
                            eligibilityHtml += `<li><strong>Education:</strong> ${eligibility.education}</li>`;
                        }
                        if (eligibility.gender) {
                            eligibilityHtml += `<li><strong>Gender:</strong> ${eligibility.gender}</li>`;
                        }
                        if (eligibility.location) {
                            eligibilityHtml += `<li><strong>Location:</strong> ${eligibility.location}</li>`;
                        }
                        if (eligibility.occupation) {
                            eligibilityHtml += `<li><strong>Occupation:</strong> ${eligibility.occupation}</li>`;
                        }
                        if (eligibility.otherRequirements && eligibility.otherRequirements.length) {
                            eligibilityHtml += `<li><strong>Other Requirements:</strong> ${eligibility.otherRequirements.join(', ')}</li>`;
                        }
                    }
                    eligibilityHtml += '</ul>';
                    document.getElementById('scheme-eligibility').innerHTML = eligibilityHtml;

                    // Benefits
                    document.getElementById('scheme-benefits').innerHTML = data.benefits ? data.benefits : 'Not specified';

                    // Apply section
                    let applyHtml = '';
                    if (data.apply) {
                        if (data.apply.how) {
                            applyHtml += `<p><strong>How to Apply:</strong> ${data.apply.how}</p>`;
                        }
                        if (data.apply.site) {
                            applyHtml += `<p><strong>Where to Apply:</strong> <a href="${data.apply.site}" target="_blank">${data.apply.site}</a></p>`;
                        }
                    }
                    document.getElementById('apply-section').innerHTML = applyHtml || 'Not specified';
                })
                .catch(err => {
                    document.getElementById('scheme-title').textContent = 'Error loading scheme';
                    document.getElementById('scheme-description').textContent = err.message;
                    document.getElementById('scheme-eligibility').textContent = '';
                    document.getElementById('scheme-benefits').textContent = '';
                    document.getElementById('apply-section').textContent = '';
                });
        } else {
            document.getElementById('scheme-title').textContent = 'No scheme selected';
            document.getElementById('scheme-description').innerHTML =
                'Please select a scheme from the schemes list to view details.<br>' +
                '<small>Tip: Open this page with a valid scheme ID, e.g. <code>scheme-details.html?id=SCHEME_ID</code></small>';
            document.getElementById('scheme-eligibility').textContent = '';
            document.getElementById('scheme-benefits').textContent = '';
            document.getElementById('apply-section').textContent = '';
        }
    </script>
</body>
</html>
